#!/bin/sh

. ~/.kshlib

DEBUG="-v --progress"

LOCK=/tmp/mirror_openbsd.lock

OPTS="-a ${DEBUG} --delete --log-file=/home/qbit/logs/mirror_openbsd.log"

EXCLUDES="alpha arm armish hp300 hppa landisk loongson mac68k mvme68k mvme88k sgi socppc sparc sparc64 vax zaurus sh mips64 mips64el m68k mips64"

EXCLUDE=""

for e in $EXCLUDES; do
	EXCLUDE="${EXCLUDE} --exclude=${e}"
done

SRC="rsync://ftp3.usa.openbsd.org/ftp/snapshots/"

if [ X${1} != X ]; then
	DST=$1
else 
	DST="/media/onetb/www/pub/OpenBSD/snapshots/"
fi

lockie $LOCK "rsync ${OPTS} ${EXCLUDE} ${SRC} ${DST}"
